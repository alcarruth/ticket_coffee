// Generated by CoffeeScript 2.4.1
(function() {
  //!/usr/bin/env coffee

  //  app.coffee

  var App, DB_RMI_Client, app, db_schema, nunjucks, options, templates;

  ({DB_RMI_Client} = require('web-worm-client'));

  ({db_schema} = require('./db_schema'));

  options = require('./settings').remote_options;

  nunjucks = require('nunjucks/browser/nunjucks-slim');

  templates = require('./templates');

  App = class App {
    constructor(options1, db_schema1, nunjucks1, templates1) {
      this.start = this.start.bind(this);
      this.options = options1;
      this.db_schema = db_schema1;
      this.nunjucks = nunjucks1;
      this.templates = templates1;
      this.client = new DB_RMI_Client(this.options);
      this.start();
    }

    start() {
      return this.client.connect().then(async(conn) => {
        this.connection = conn;
        return this.db = (await conn.init_db());
      }).catch((error) => {
        console.log("trouble starting app :-(");
        return console.log(error);
      });
    }

  };

  app = new App(options, db_schema, nunjucks, templates);

  if (typeof window !== "undefined" && window !== null) {
    window.app = app;
  } else {
    exports.app = app;
  }

}).call(this);
